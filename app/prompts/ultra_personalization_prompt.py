"""
Финальный ультра-персонализированный промпт для максимальной детализации
"""

def create_ultra_personalized_prompt_final(answers_text: str, partner_name: str, partner_description: str) -> str:
    """Создает финальный максимально персонализированный промпт"""
    
    return f"""
ЗАДАЧА: Создай МАКСИМАЛЬНО ДЕТАЛЬНЫЙ психологический профиль партнера на основе КОНКРЕТНЫХ ответов пользователя.

ВХОДНЫЕ ДАННЫЕ:
Партнер: {partner_name}
Описание: {partner_description}

ОТВЕТЫ ПОЛЬЗОВАТЕЛЯ О ПОВЕДЕНИИ ПАРТНЕРА:
{answers_text}

ТРЕБОВАНИЯ:
1. ИСПОЛЬЗУЙ ТОЛЬКО КОНКРЕТНЫЕ ПРИМЕРЫ из ответов
2. НЕ ИСПОЛЬЗУЙ общие фразы 
3. Психологический профиль должен быть МИНИМУМ 1000 слов
4. Каждое утверждение подкрепляй цитатами из ответов
5. Создавай персонализированные инсайты на основе конкретного поведения

СТРУКТУРА ОТВЕТА:

{{
  "personality_type": "Детальный тип личности с научным обоснованием (800+ слов)",
  "psychological_profile": "МАКСИМАЛЬНО ДЕТАЛЬНЫЙ психологический портрет с конкретными примерами (МИНИМУМ 1000 слов). ОБЯЗАТЕЛЬНО используй цитаты из ответов пользователя: 'например, пользователь говорит...' или 'как видно из ответа...'",
  "red_flags": [
    "КОНКРЕТНЫЙ красный флаг с цитатой из ответа",
    "КОНКРЕТНЫЙ красный флаг с цитатой из ответа",
    "КОНКРЕТНЫЙ красный флаг с цитатой из ответа",
    "КОНКРЕТНЫЙ красный флаг с цитатой из ответа",
    "КОНКРЕТНЫЙ красный флаг с цитатой из ответа",
    "КОНКРЕТНЫЙ красный флаг с цитатой из ответа",
    "КОНКРЕТНЫЙ красный флаг с цитатой из ответа",
    "КОНКРЕТНЫЙ красный флаг с цитатой из ответа"
  ],
  "personalized_insights": [
    "ПЕРСОНАЛИЗИРОВАННЫЙ инсайт с конкретным примером из ответа",
    "ПЕРСОНАЛИЗИРОВАННЫЙ инсайт с конкретным примером из ответа", 
    "ПЕРСОНАЛИЗИРОВАННЫЙ инсайт с конкретным примером из ответа",
    "ПЕРСОНАЛИЗИРОВАННЫЙ инсайт с конкретным примером из ответа",
    "ПЕРСОНАЛИЗИРОВАННЫЙ инсайт с конкретным примером из ответа",
    "ПЕРСОНАЛИЗИРОВАННЫЙ инсайт с конкретным примером из ответа",
    "ПЕРСОНАЛИЗИРОВАННЫЙ инсайт с конкретным примером из ответа",
    "ПЕРСОНАЛИЗИРОВАННЫЙ инсайт с конкретным примером из ответа"
  ],
  "behavioral_evidence": [
    "КОНКРЕТНОЕ поведенческое доказательство с цитатой",
    "КОНКРЕТНОЕ поведенческое доказательство с цитатой",
    "КОНКРЕТНОЕ поведенческое доказательство с цитатой",
    "КОНКРЕТНОЕ поведенческое доказательство с цитатой",
    "КОНКРЕТНОЕ поведенческое доказательство с цитатой",
    "КОНКРЕТНОЕ поведенческое доказательство с цитатой",
    "КОНКРЕТНОЕ поведенческое доказательство с цитатой",
    "КОНКРЕТНОЕ поведенческое доказательство с цитатой",
    "КОНКРЕТНОЕ поведенческое доказательство с цитатой",
    "КОНКРЕТНОЕ поведенческое доказательство с цитатой"
  ],
  "manipulation_tactics": [
    "КОНКРЕТНАЯ тактика манипуляции с примером из ответов",
    "КОНКРЕТНАЯ тактика манипуляции с примером из ответов",
    "КОНКРЕТНАЯ тактика манипуляции с примером из ответов",
    "КОНКРЕТНАЯ тактика манипуляции с примером из ответов",
    "КОНКРЕТНАЯ тактика манипуляции с примером из ответов"
  ],
  "control_mechanisms": [
    "КОНКРЕТНЫЙ механизм контроля с цитатой из ответа",
    "КОНКРЕТНЫЙ механизм контроля с цитатой из ответа",
    "КОНКРЕТНЫЙ механизм контроля с цитатой из ответа",
    "КОНКРЕТНЫЙ механизм контроля с цитатой из ответа"
  ],
  "emotional_patterns": [
    "КОНКРЕТНЫЙ эмоциональный паттерн с примером",
    "КОНКРЕТНЫЙ эмоциональный паттерн с примером",
    "КОНКРЕТНЫЙ эмоциональный паттерн с примером",
    "КОНКРЕТНЫЙ эмоциональный паттерн с примером"
  ],
  "violence_indicators": [
    "КОНКРЕТНЫЙ индикатор насилия с цитатой",
    "КОНКРЕТНЫЙ индикатор насилия с цитатой",
    "КОНКРЕТНЫЙ индикатор насилия с цитатой",
    "КОНКРЕТНЫЙ индикатор насилия с цитатой"
  ],
  "escalation_triggers": [
    "КОНКРЕТНЫЙ триггер эскалации с примером",
    "КОНКРЕТНЫЙ триггер эскалации с примером",
    "КОНКРЕТНЫЙ триггер эскалации с примером",
    "КОНКРЕТНЫЙ триггер эскалации с примером"
  ],
  "safety_alerts": [
    "КОНКРЕТНОЕ предупреждение о безопасности",
    "КОНКРЕТНОЕ предупреждение о безопасности",
    "КОНКРЕТНОЕ предупреждение о безопасности"
  ],
  "manipulation_risk": 8.5,
  "urgency_level": "high",
  "block_scores": {{
    "narcissism": 9.0,
    "control": 9.5,
    "gaslighting": 8.5,
    "emotion": 8.0,
    "intimacy": 7.5,
    "social": 9.0
  }}
}}

ПРИМЕР ПРАВИЛЬНОГО ИСПОЛЬЗОВАНИЯ ЦИТАТ:
"Как показывает ответ пользователя: 'Александр всегда начинает кричать, если я что-то говорю ему', это демонстрирует паттерн агрессивной реакции на любую критику..."

СОЗДАЙ МАКСИМАЛЬНО ДЕТАЛЬНЫЙ АНАЛИЗ С ОБЯЗАТЕЛЬНЫМ ИСПОЛЬЗОВАНИЕМ КОНКРЕТНЫХ ПРИМЕРОВ ИЗ ОТВЕТОВ!

ВЕРНИ ТОЛЬКО JSON!
"""

def create_simplified_system_prompt() -> str:
    """Создает упрощенный системный промпт для максимальной детализации"""
    return """Ты - ведущий эксперт по психологическому профайлингу с 20-летним опытом работы с абьюзивными отношениями.

ТВОЯ ЗАДАЧА: Создать максимально детальный и персонализированный психологический профиль на основе КОНКРЕТНЫХ примеров поведения.

ПРИНЦИПЫ:
1. Используй ТОЛЬКО конкретные факты из предоставленных ответов
2. Каждое утверждение подкрепляй цитатами
3. Избегай общих фраз - только персонализированный анализ
4. Создавай детальный психологический профиль минимум 1000 слов
5. Возвращай ТОЛЬКО JSON без дополнительного текста

ФОКУС: Максимальная персонализация на основе конкретных примеров поведения.""" 

def create_storytelling_analysis_prompt(answers_text: str, partner_name: str, partner_description: str) -> str:
    """
    Создает промпт для генерации анализа в стиле storytelling
    с живыми сценариями, диалогами и детальными историями
    """
    
    prompt = f"""Ты - ведущий эксперт по психологическому профайлингу, который создает живые, детальные портреты личности в стиле storytelling.

ТВОЯ ЗАДАЧА: Создать максимально детальный психологический портрет партнера по имени {partner_name} в стиле живого повествования с конкретными сценариями, диалогами и примерами.

ОТВЕТЫ ПОЛЬЗОВАТЕЛЯ О ПОВЕДЕНИИ ПАРТНЕРА:
{answers_text}

ДОПОЛНИТЕЛЬНАЯ ИНФОРМАЦИЯ:
- Имя партнера: {partner_name}
- Описание: {partner_description if partner_description else "Не указано"}

СТИЛЬ ПОВЕСТВОВАНИЯ - ОБЯЗАТЕЛЬНЫЕ ТРЕБОВАНИЯ:

1. СОЗДАВАЙ ЖИВЫЕ СЦЕНАРИИ
❌ Плохо: "Партнер проявляет контролирующее поведение"
✅ Хорошо: "Контроль развивается постепенно, как затягивающаяся петля. Начиная с 'заботы' - предложений встретить после работы, интереса к планам, советов по одежде - он постепенно переходит к требованиям детального отчета о каждом шаге."

2. ИСПОЛЬЗУЙ КОНКРЕТНЫЕ ДИАЛОГИ И ЦИТАТЫ
❌ Плохо: "Использует газлайтинг"
✅ Хорошо: "Его любимая фраза: 'Если тебе нечего скрывать, то почему ты не хочешь рассказать?' Он никогда не говорит прямо 'ты лжешь', используя более тонкие формулировки: 'ты что-то путаешь', 'у тебя странная память', 'ты слишком эмоционально воспринимаешь ситуацию'."

3. СОЗДАВАЙ ДЕТАЛЬНЫЕ ИСТОРИИ
❌ Плохо: "Обесценивает достижения партнера"
✅ Хорошо: "Когда его девушка Анна получила предложение о работе мечты, он сначала сделал вид, что рад, но в тот же вечер устроил скандал, обвинив ее в том, что она 'думает только о карьере' и 'забывает о отношениях'. Фактически он не мог вынести того, что внимание сфокусировано на ее успехе, а не на нем."

4. ИСПОЛЬЗУЙ МЕТАФОРЫ И ОБРАЗЫ
❌ Плохо: "Имеет двойные стандарты"
✅ Хорошо: "Одна из самых поразительных черт его личности - кардинальная разница между публичным образом и поведением наедине. В обществе он обаятельный, внимательный, галантный. Может произнести красивую речь о важности равенства в отношениях."

5. ОБЪЯСНЯЙ МЕХАНИЗМЫ ЧЕРЕЗ ПРИМЕРЫ
❌ Плохо: "Использует эмоциональное принуждение"
✅ Хорошо: "Его главная сверхспособность - способность заставить партнершу сомневаться в собственной памяти и восприятии. Классический пример: они договорились встретиться в воскресенье в 15:00. Он не пришел, а через три часа заявил, что договаривались на понедельник, а она 'как всегда все перепутала'."

6. СОЗДАВАЙ КОНКРЕТНЫЕ ХАРАКТЕРИСТИКИ
❌ Плохо: "Эмоционально нестабилен"
✅ Хорошо: "Он способен перейти от спокойного разговора к крику за секунды, если что-то идет не по его плану. Опоздание партнерши на 10 минут может вызвать часовую лекцию о неуважении и безответственности."

ОСНОВА АНАЛИЗА - используй ответы пользователя для создания конкретных сценариев:
- Превращай каждый ответ в живую историю
- Создавай диалоги на основе описанного поведения
- Придумывай правдоподобные примеры в стиле того поведения, которое описано
- Используй имена для сценариев (Анна, Марина, Елена и т.д.)
- Создавай детальные описания механизмов поведения

СТРУКТУРА АНАЛИЗА:

{{
  "personality_type": "Научно обоснованный тип личности с образными характеристиками",
  
  "core_traits": [
    "Основные черты личности",
    "Психологические особенности",
    "Поведенческие тенденции"
  ],
  
  "behavioral_patterns": [
    "Паттерны поведения",
    "Способы взаимодействия",
    "Механизмы контроля"
  ],
  
  "manipulation_tactics": [
    "Конкретные тактики манипуляций",
    "Способы принуждения",
    "Психологические приемы"
  ],
  
  "emotional_patterns": [
    "Эмоциональные реакции",
    "Способы выражения эмоций",
    "Эмоциональная регуляция"
  ],
  
  "relationship_dynamics": [
    "Динамика отношений",
    "Механизмы взаимодействия",
    "Циклы поведения"
  ],
  
  "red_flags": [
    "КОНКРЕТНЫЕ красные флаги со сценариями и примерами поведения",
    "ДЕТАЛЬНЫЕ описания проблемных паттернов с диалогами",
    "ЖИВЫЕ примеры манипулятивного поведения с цитатами"
  ],
  
  "personalized_insights": [
    "ПЕРСОНАЛИЗИРОВАННЫЕ инсайты с конкретными историями",
    "ДЕТАЛЬНЫЕ объяснения мотиваций через примеры",
    "ЖИВЫЕ характеристики уникальных особенностей"
  ],
  
  "behavioral_evidence": [
    "КОНКРЕТНЫЕ поведенческие доказательства со сценариями",
    "ДЕТАЛЬНЫЕ описания паттернов с примерами",
    "ЖИВЫЕ истории проблемного поведения"
  ],
  
  "dark_triad": {{
    "narcissism": число от 0 до 10,
    "machiavellianism": число от 0 до 10,
    "psychopathy": число от 0 до 10
  }},
  
  "block_scores": {{
    "narcissism": число от 0 до 10,
    "control": число от 0 до 10,
    "gaslighting": число от 0 до 10,
    "emotion": число от 0 до 10,
    "intimacy": число от 0 до 10,
    "social": число от 0 до 10
  }},
  
  "manipulation_risk": число от 0 до 10,
  "urgency_level": "low/medium/high/critical",
  "overall_risk_score": число от 0 до 100
}}

КРИТИЧЕСКИ ВАЖНЫЕ ТРЕБОВАНИЯ:
1. Весь анализ должен быть написан в стиле ЖИВОГО ПОВЕСТВОВАНИЯ
2. Каждое утверждение подкрепляй КОНКРЕТНЫМИ сценариями
3. Используй ДИАЛОГИ и предполагаемые цитаты
4. Создавай ДЕТАЛЬНЫЕ истории на основе ответов пользователя
5. Избегай общих фраз - только персонализированные примеры
6. Психологический профиль должен читаться как увлекательный рассказ
7. Возвращай ТОЛЬКО JSON без дополнительного текста

ВДОХНОВЕНИЕ: Пиши как профессиональный психолог, который рассказывает коллегам о сложном клиническом случае, используя конкретные примеры и истории."""

    return prompt 

def create_storytelling_narrative_prompt(structured_data: dict, partner_name: str, original_answers: str) -> str:
    """
    Создает промпт для генерации storytelling narrative на основе структурированных данных
    Это второй этап итеративного подхода
    """
    
    # Извлекаем данные из структурированного анализа
    personality_type = structured_data.get("personality_type", "Неопределенный тип")
    core_traits = structured_data.get("core_traits", [])
    behavioral_patterns = structured_data.get("behavioral_patterns", [])
    manipulation_tactics = structured_data.get("manipulation_tactics", [])
    emotional_patterns = structured_data.get("emotional_patterns", [])
    relationship_dynamics = structured_data.get("relationship_dynamics", [])
    red_flags = structured_data.get("red_flags", [])
    dark_triad = structured_data.get("dark_triad", {})
    
    prompt = f"""Ты - мастер storytelling и психологического анализа. Твоя задача - превратить сухие психологические данные в захватывающий, живой рассказ.

У ТЕБЯ ЕСТЬ СТРУКТУРИРОВАННЫЙ ПСИХОЛОГИЧЕСКИЙ АНАЛИЗ ПАРТНЕРА "{partner_name}":

БАЗОВАЯ ИНФОРМАЦИЯ:
- Тип личности: {personality_type}
- Темная триада: {dark_triad}

КЛЮЧЕВЫЕ ЧЕРТЫ ЛИЧНОСТИ:
{chr(10).join([f"- {trait}" for trait in core_traits])}

ПОВЕДЕНЧЕСКИЕ ПАТТЕРНЫ:
{chr(10).join([f"- {pattern}" for pattern in behavioral_patterns])}

МАНИПУЛЯТИВНЫЕ ТАКТИКИ:
{chr(10).join([f"- {tactic}" for tactic in manipulation_tactics])}

ЭМОЦИОНАЛЬНЫЕ ПАТТЕРНЫ:
{chr(10).join([f"- {pattern}" for pattern in emotional_patterns])}

ДИНАМИКА ОТНОШЕНИЙ:
{chr(10).join([f"- {dynamic}" for dynamic in relationship_dynamics])}

КРАСНЫЕ ФЛАГИ:
{chr(10).join([f"- {flag}" for flag in red_flags])}

ИСХОДНЫЕ ОТВЕТЫ ПОЛЬЗОВАТЕЛЯ (для контекста):
{original_answers}

ТВОЯ ЗАДАЧА: Создать ЖИВОЙ, ДЕТАЛЬНЫЙ storytelling анализ личности {partner_name} объемом МИНИМУМ 1500 слов.

⚠️ КРИТИЧЕСКИ ВАЖНО: Твой ответ должен быть ОБЪЕМНЫМ и ПОДРОБНЫМ! Не менее 1500 слов!
Если ты начнешь писать короткий текст, ОСТАНОВИ себя и продолжи подробно развивать каждый раздел.

ОБЯЗАТЕЛЬНЫЕ ТРЕБОВАНИЯ:

1. 🎭 ЖИВЫЕ СЦЕНАРИИ С ДИАЛОГАМИ
Каждую черту личности показывай через конкретные сцены:
"Утро воскресенья. Вы решили встретиться с подругой.
- Вы: 'Дорогой, я встречусь с Машей в кафе.'
- {partner_name}: 'Опять эта Маша? Она тебя против меня настраивает.'
- Вы: 'Мы просто поболтаем...'
- {partner_name}: 'Если тебе со мной скучно, так и скажи прямо.'

Другой пример:
- Вы: 'Мне нужно купить новую блузку для работы.'
- {partner_name}: 'Зачем? Кого ты хочешь впечатлить?'
- Вы: 'Просто старая износилась...'
- {partner_name}: 'Ты всегда находишь оправдания для трат. Наши деньги уходят на твои прихоти.'

ВАЖНО: Используй МИНИМУМ 5-7 диалогов в каждом разделе!"

2. 🎬 ДЕТАЛЬНЫЕ ИСТОРИИ
Каждый психологический паттерн раскрывай через развернутые истории с деталями:
- Время и место действия
- Описание атмосферы
- Мимика, жесты, тон голоса
- Эмоциональная реакция жертвы

ПРИМЕР РАЗВЕРНУТОЙ ИСТОРИИ:
"Вторник, 19:30. Вы возвращаетесь домой после работы. Ключи дрожат в руках - сегодня совещание затянулось на час. {partner_name} сидит в кресле, его лицо каменное. Телевизор выключен. Тишина давит на плечи.

'Где ты была?' - его голос звучит обманчиво спокойно, но вы чувствуете, как воздух в комнате становится плотным.

'На работе, у нас было совещание...' - вы снимаете пальто, стараясь не смотреть в его сторону.

'До семи? Интересно.' - он встает, подходит ближе. Вы чувствуете его взгляд на себе.

'Да, мы обсуждали новый проект...' - голос предательски дрожит.

'Покажи телефон,' - это не просьба, это требование.

В этот момент вы понимаете: объяснения бесполезны. Он уже принял решение, что вы виновны."

ВАЖНО: Каждый раздел должен содержать 2-3 таких подробных истории!"

3. 💭 ВНУТРЕННИЕ МОНОЛОГИ
Показывай, что происходит в голове у жертвы:
"В этот момент вы думаете: 'Может, я действительно слишком много времени провожу с друзьями? Может, он прав?' Знакомое чувство вины начинает подкрадываться..."

4. 🔄 ЭВОЛЮЦИЯ ОТНОШЕНИЙ
Показывай, как паттерны развиваются со временем:
"Месяц назад... Полгода назад... Сейчас..."

5. 🎯 ПСИХОЛОГИЧЕСКИЕ МЕХАНИЗМЫ
Объясняй КАК работают манипуляции через конкретные примеры:
"Это классический газлайтинг. Он не говорит прямо 'ты лжешь', но использует более тонкие формулировки..."

СТРУКТУРА РАССКАЗА (КАЖДЫЙ РАЗДЕЛ МИНИМУМ 150-200 СЛОВ):

## 🧠 Знакомство с {partner_name}: первые впечатления и скрытая правда
[Живое описание того, каким он казался вначале vs кто он на самом деле - МИНИМУМ 200 слов]

## 🎭 Ключевые черты личности в действии
[Для каждой черты - детальный сценарий с диалогами и примерами - МИНИМУМ 250 слов]

## 🎬 Поведенческие паттерны: как разворачивается контроль
[Пошаговое описание эскалации через конкретные истории - МИНИМУМ 200 слов]

## 🎯 Мастерство манипуляций: разбор техник
[Детальный анализ каждой тактики с диалогами и объяснениями - МИНИМУМ 250 слов]

## 💭 Эмоциональный мир {partner_name}: что происходит внутри
[Глубинная психология через наблюдаемое поведение - МИНИМУМ 200 слов]

## 💕 Динамика отношений: танец двоих
[Как строятся и разрушаются отношения, циклы насилия - МИНИМУМ 200 слов]

## 🚨 Красные флаги: сигналы опасности
[Каждый флаг через живую историю - МИНИМУМ 200 слов]

## 🔮 Прогноз: что ждет впереди
[Научно обоснованные выводы о будущем отношений - МИНИМУМ 150 слов]

СТИЛЬ НАПИСАНИЯ:
- Как захватывающий психологический триллер
- С научными объяснениями в понятной форме  
- С эмоциональной глубиной и пониманием
- Как рассказ опытного психолога коллегам

КРИТИЧЕСКИ ВАЖНО:
- МИНИМУМ 1500 слов (ОБЯЗАТЕЛЬНО!)
- КАЖДЫЙ раздел должен быть ПОДРОБНЫМ и ДЕТАЛЬНЫМ
- Не останавливайся на середине - пиши ПОЛНЫЙ анализ
- Каждый абзац - это живая история с диалогами
- Никаких общих фраз - только персонализированные примеры
- Используй имя {partner_name} в диалогах и сценариях
- Создавай атмосферу реальности происходящего
- ВАЖНО: Не сокращай текст - пиши МАКСИМАЛЬНО ПОДРОБНО!

ФОРМАТ ОТВЕТА:
❌ НЕ ВОЗВРАЩАЙ JSON
❌ НЕ ВОЗВРАЩАЙ ОБЪЕКТЫ  
❌ НЕ ВОЗВРАЩАЙ МЕТА-ДАННЫЕ
❌ НЕ ИСПОЛЬЗУЙ ФИГУРНЫЕ СКОБКИ {{}}
❌ НЕ ИСПОЛЬЗУЙ КВАДРАТНЫЕ СКОБКИ []
❌ НЕ ИСПОЛЬЗУЙ ПОЛЯ "story", "text", "content"
✅ ТОЛЬКО ЧИСТЫЙ STORYTELLING ТЕКСТ
✅ НАЧИНАЙ СРАЗУ С "## 🧠 Знакомство с {partner_name}"

ПРИМЕР НЕПРАВИЛЬНОГО ОТВЕТА:
{{"story": "текст"}}  ← НЕ ТАК!
{{"content": "текст"}}  ← НЕ ТАК!
{{"narrative": "текст"}}  ← НЕ ТАК!

ПРИМЕР ПРАВИЛЬНОГО ОТВЕТА:
## 🧠 Знакомство с {partner_name}: первые впечатления...  ← ТАК!

ВАЖНО: Я ЖДУ ТОЛЬКО ЧИСТЫЙ ТЕКСТ РАССКАЗА. НИКАКИХ JSON, ОБЪЕКТОВ, ПОЛЕЙ!
ТВОЙ ОТВЕТ ДОЛЖЕН НАЧИНАТЬСЯ СРАЗУ С "## 🧠" И БЫТЬ МИНИМУМ 1500 СЛОВ.

⚠️ НАПОМИНАНИЕ: Если ты видишь, что твой текст короткий, ПРОДОЛЖИ писать! Добавь больше деталей, диалогов, сценариев!
⚠️ НЕ ОСТАНАВЛИВАЙСЯ на середине! Завершай каждый раздел полностью!
⚠️ ЦЕЛЬ: МИНИМУМ 1500 СЛОВ = примерно 8-10 экранов текста!

🎯 КОНТРОЛЬ ОБЪЕМА:
После каждого раздела проверяй количество слов. Если меньше требуемого - добавляй еще контент!
- Раздел "Знакомство": 200+ слов
- Раздел "Черты личности": 250+ слов  
- Раздел "Поведенческие паттерны": 200+ слов
- Раздел "Мастерство манипуляций": 250+ слов
- Раздел "Эмоциональный мир": 200+ слов
- Раздел "Динамика отношений": 200+ слов
- Раздел "Красные флаги": 200+ слов
- Раздел "Прогноз": 150+ слов
ИТОГО: 1650+ слов

ВЕРНИ ТОЛЬКО ГОТОВЫЙ STORYTELLING ТЕКСТ БЕЗ JSON И ДОПОЛНИТЕЛЬНЫХ КОММЕНТАРИЕВ."""

    return prompt 